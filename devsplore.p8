pico-8 cartridge // http://www.pico-8.com
version 29
__lua__
--devsplore
--par nas

function _init()
create_player()
create_enemy()
score=0
state=0
enemies={e,f}
--hasenemy=false
end

function _update()
--lancement du jeu state=0
if (state==0) update_game()
if (state==1) update_gameover()
end

function _draw()
if (state==0) draw_game()
if (state==1) draw_gameover()
end


-->8
--map

function draw_map()
	map(0,0,0,0,128,64)
end

function check_flag(flag,x,y)
	local sprite=mget(x,y)
	return fget(sprite,flag)
end

function update_camera()
--local camx=mid(0,p.x-7.5,127-15)
--local camy=mid(0,p.y-7.5,63-15)
local camx=flr(p.x/16)*16
local camy=flr(p.y/16)*16
camera(camx*8,camy*8)
end
-->8
--personnage principal

function create_player()
p={
	x=3,
	y=15,
	sprite=1
}
end

function draw_player()
	spr(p.sprite,p.x*8,p.y*8)
end

function player_movement()
	newx=p.x
	newy=p.y

	if(btn(➡️)) newx+=1
	if(btn(⬅️)) newx-=1
	if(btn(⬇️)) newy+=1
	if(btn(⬆️)) newy-=1

	if not check_flag(0,newx,newy) then
		p.x=newx
		p.y=newy
	end
end
-->8
--score

function update_game()
player_movement()
--enemy_movement()
update_enemies()
--delete_enemies()
collision(p,e)
--for e in all (enemies) do
--if collision(p,e)==true then
--del(enemies,e)
-- end
--end
lose_score()
--if hasenemy == false
--then
--spawn_enemies(3)
--hasenemy = true
--end
update_camera()
state=1
end

function update_gameover()
state=0
end

--affichage jeu
function draw_game()
cls(3)
draw_map()
draw_player()
draw_enemy() 
--for e in all(enemies) do
--spr(11,e.x,e.y)
--end
--score view=confiance
print("confiance: ",3,2,1)
print(score,42,2,1)
print("confiance: ",160,2,1)
end

--function draw_ui()
--print("confiance: ",3,2,1)
--print(score,42,2,1)
--end

function draw_gameover()
-- ici afficher le menu gameover
end

--lose confiance
function lose_score()
		if collision()==true then
		 score-=10
	end
end



-->8
--ememies

function create_enemy()
e={
	x=112,
	y=64,
	sprite=11
}

f={
	x=56,
	y=72,
	sprite=23
}
end

function draw_enemy()
	spr(e.sprite,e.x,e.y)
	spr(f.sprite,f.x,f.y)
end

--function enemy_movement()
--	newx=e.x
--	newy=e.y

--if not check_flag(0,newx,newy) then
--	e.x=newx
	--e.y=newy
--end
--end

--function spawn_enemies(amount)
--	for i=1,amount do
	--	new_enemy = {
 -- 	x = 60,
 -- 	y = 10,
 -- 	life=4,
 --	}
	--	add(enemies, new_enemy) 
--	end
--end

function update_enemies()
	for e in all(enemies) do
		if e.x>100 then
		e.x-=0.3
		end
		if f.x>40 then
		f.x-=0.3
		end
	end
end

--supprimer les ennemis de la map
function delete_enemies()
for e in all(enemies) do
	if e.x<=100 then
		e.x+=0.3
		end
	end
end

--collision
function collision()
for e in all(enemies) do
	if p.x==e.x then
		return true
	end
end
end

--if p.x>e.x+8
--or p.y>e.y+8
--or p.x+8<e.x
--or p.y+8<e.y then
-- return false
--else
-- return true
-- end
--end 

--for e in all (enemies) do
--if collision(p,e) then
--del(enemies,e)
-- end
--end
__gfx__
00000000005cc90060606060444444444444000044444444000000446000000000000000000000000bb6b6b00005500000000000000000000000000000000000
0000000005c5cc900000000044444444444400004444444400000044000000000000000000000006b9bb9bbb0555555000000000000000000000000000000000
007007000cf1f1c00000000000000000444400004444444400000044600000000000000000000000669bb9b65055550500000000000000000000000000000000
0007700000cfff000000000000000000444400004444444400000044000000000000000000000006b64baabb5055550500000000000000000000000000000000
000770000022f80000000000000000004444000044444444000000446000000000000000000000000b696b6b0555555000000000000000000000000000000000
00700700f222288f000000000000000044440000444444440000004400000000000000000000000600b6b6b05095590500000000000000000000000000000000
00000000002558000000000000000000444400004444444400000044600000000000000000000000000440005050050500000000000000000000000000000000
0000000000555d000000000000000000444400004444444400000044000000006060606000000006000540000000000000000000000000000000000000000000
000000006666666600000000008000000000900088888888eeeeeeee05bb55000000000000000000000000000000000000000000000000000000000000000000
00000000666666660900009008a8b0000009890088888888eeeeeeee55b5b5000000000000000000000000000000000000000000000000000000000000000000
000000006666666649444494bb80b00b0900900088888888eeeeeeee5bbbb5050000000000000000000000000000000000000000000000000000000000000000
0000000066666666494994940bbbb8bb9890009088888888eeeeeeee585b55590000000000000000000000000000000000000000000000000000000000000000
0000000066666666494994940bbb8a800900098988888888eeeeeeee855b55400000000000000000000000000000000000000000000000000000000000000000
000000006666666649444494beebb8bb0009009088888888eeeeeeee059b5bb90000000000000000000000000000000000000000000000000000000000000000
000000006666666609000090bbbeeeb00098900088888888eeeeeeee059bbb450000000000000000000000000000000000000000000000000000000000000000
000000006666666600000000bbbbbbb00009000088888888eeeeeeee055949550000000000000000000000000000000000000000000000000000000000000000
__gff__
0000010101010101010101010000000000000101010000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
0a0a0a0c0a0a0a0a0a0a0a0a0a0a0a0a16161616000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0a0a000a00000a0a00140a0a0a14140416161515000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0a000012120a1212121111111111111116151615000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0a0a1311111111111111130a0a13131116161515212121212121212121212121000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0a00131114130a13130a21212114210416161616212121212121212121212121000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0a00131111111111111114212114210416161616212121212121212121212121000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0a0a00121312120a0a1111112114210416161615212121212121212121212121000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0a0c142121210a000a1113140a21210416161515212121212121212121212121000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0a000a1421211313131111111111110416151615212121212121212121212121000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0a00210a14111111121221211313110416161515212121212121212121212121000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0a0a21210c1411132121210a1111110416161616212121212121212121212121000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0a0013121212110a0a1321141112130416161616212121212121212121212121000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0a0a1111111111212113210a1111130416161515212121212121212121212121000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0a0a1114141414212114210a0a11130416151615212121212121212121212121000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0c0a111414141412131313121211130416161515212121212121212121212121000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0a0a1111111111111111111111110a0416161616212121212121212121212121000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000c121412140a0a0a110a121212210505050505050521212121212121212121000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000021212121210a21210a212121212121212121212121212121212121212121000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000021212121210a21210a212121212121212121212121212121212121212121000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000021212121210a0a0a0a212121212121212121212121212121212121212121000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__sfx__
000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
002e0000094500e4500a4500e45021000174001b400164001b400301003410030100301003010030100301002e1002a1002410023100221002410028100311000000000000000000000000000000000000000000
